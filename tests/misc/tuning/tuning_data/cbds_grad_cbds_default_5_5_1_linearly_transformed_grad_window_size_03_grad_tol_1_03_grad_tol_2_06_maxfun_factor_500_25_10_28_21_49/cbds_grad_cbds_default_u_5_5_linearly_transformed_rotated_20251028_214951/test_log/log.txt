
INFO: The script or function that calls `benchmark` function is copied to
/Users/lihaitian/Work/bds/tests/tuning/tuning_data/cbds_grad_cbds_default_5_5_1_linearly_transformed_grad_window_size_03_grad_tol_1_03_grad_tol_2_06_maxfun_factor_500_25_10_28_21_49/cbds_grad_cbds_default_u_5_5_linearly_transformed_rotated_20251028_214951/test_log

INFO: Start testing with the following options
INFO: - Solvers: cbds-grad, cbds-default
INFO: - Problem libraries: s2mpj
INFO: - Problem types: u
INFO: - Problem dimension range: [5, 5]
INFO: - Number of user-excluded problem names: 38
INFO: - Feature stamp: linearly_transformed_rotated

INFO: Start testing problems from the problem library "s2mpj" with the "linearly_transformed" feature.

INFO: More information about the S2MPJ problem library can be found at
https://github.com/GrattonToint/S2MPJ

INFO: There are 12 problems from "s2mpj" to test.

INFO: Loading problem   BROYDN3DLS from "s2mpj".

INFO: Start  solving    BROYDN3DLS with cbds-grad    (run  1/ 1).
dbquit
clc
p = s2mpj_load('EIGENALS')

p = 

  <a href="matlab:helpPopup('Problem')" style="font-weight:bold">Problem</a> with properties:

              name: 'EIGENALS'
                x0: [6×1 double]
                xl: [6×1 double]
                xu: [6×1 double]
               aub: [0×6 double]
               bub: [0×1 double]
               aeq: [0×6 double]
               beq: [0×1 double]
                 n: 6
                mb: 0
       m_linear_ub: 0
       m_linear_eq: 0
    m_nonlinear_ub: 0
    m_nonlinear_eq: 0
             mlcon: 0
            mnlcon: 0
              mcon: 0
             ptype: 'u'

q = @(x) p.fun(x)

q =

  <a href="matlab:helpPopup('function_handle')" style="font-weight:bold">function_handle</a> with value:

    @(x)p.fun(x)

clear all
clc
p = s2mpj_load('EIGENALS')

p = 

  <a href="matlab:helpPopup('Problem')" style="font-weight:bold">Problem</a> with properties:

              name: 'EIGENALS'
                x0: [6×1 double]
                xl: [6×1 double]
                xu: [6×1 double]
               aub: [0×6 double]
               bub: [0×1 double]
               aeq: [0×6 double]
               beq: [0×1 double]
                 n: 6
                mb: 0
       m_linear_ub: 0
       m_linear_eq: 0
    m_nonlinear_ub: 0
    m_nonlinear_eq: 0
             mlcon: 0
            mnlcon: 0
              mcon: 0
             ptype: 'u'

q = @(x) p.fun(x)

q =

  <a href="matlab:helpPopup('function_handle')" style="font-weight:bold">function_handle</a> with value:

    @(x)p.fun(x)

clc
options.use_estimated_gradient_stop = true;
options.grad_tol_1 = 1e-1;
options.grad_tol_2 = 1e-3;
options.MaxFunctionEvaluations = 3000;
[a, b, c, d] = bds(q, p.x0, options)
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 

a =

     1
     1
     0
     2
     0
     1


b =

     0


c =

     0


d = 

  <a href="matlab:helpPopup('struct')" style="font-weight:bold">struct</a> with fields:

      funcCount: 404
          fhist: [1 2 2 19 3 5 5 0 4 4 45 5 0.4225 0.4225 5.9340 1.5400 … ] (1×404 double)
      grad_hist: [6×32 double]
     grad_xhist: [6×32 double]
    alpha_final: [6×1 double]
        message: "The StepTolerance of the step size is reached."

[a, b, c, d] = bds(q, p.x0, options)
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 

a =

     1
     1
     0
     2
     0
     1


b =

     0


c =

     0


d = 

  <a href="matlab:helpPopup('struct')" style="font-weight:bold">struct</a> with fields:

         funcCount: 404
             fhist: [1 2 2 19 3 5 5 0 4 4 45 5 0.4225 0.4225 5.9340 … ] (1×404 double)
         grad_hist: [6×32 double]
        grad_xhist: [6×32 double]
       alpha_final: [6×1 double]
    norm_grad_hist: []
           message: "The StepTolerance of the step size is reached."

[a, b, c, d] = bds(q, p.x0, options)
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 

a =

     1
     1
     0
     2
     0
     1


b =

     0


c =

     0


d = 

  <a href="matlab:helpPopup('struct')" style="font-weight:bold">struct</a> with fields:

      funcCount: 404
          fhist: [1 2 2 19 3 5 5 0 4 4 45 5 0.4225 0.4225 5.9340 1.5400 … ] (1×404 double)
      grad_hist: [6×32 double]
     grad_xhist: [6×32 double]
    alpha_final: [6×1 double]
        message: "The StepTolerance of the step size is reached."

vecnorm(d.grad_hist)

ans =

  Columns 1 through 9

    9.1009    3.8451    1.6246    0.6864    0.2900    0.1225    0.0518    0.0219    0.0092

  Columns 10 through 18

    0.0039    0.0016    0.0007    0.0003    0.0001    0.0001    0.0000    0.0000    0.0000

  Columns 19 through 27

    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000

  Columns 28 through 32

    0.0000    0.0000    0.0000    0.0000    0.0000

clc
[a, b, c, d] = bds(q, p.x0, options)
norm(grad)

ans =

    9.1009

grad_error

grad_error =

    0.3043

grad_error

grad_error =

    0.3043

clc
grad_error

grad_error =

    0.3043

norm(grad)

ans =

    9.1009

dbcont
Warning: The estimated gradient might be inaccurate. 
norm(grad)

ans =

    3.8451

grad_error

grad_error =

    0.1286

dbcont
Warning: The estimated gradient might be inaccurate. 
norm(grad)

ans =

    1.6246

grad_error

grad_error =

    0.0543

dbquit
clc
[a, b, c, d] = bds(q, p.x0, options)
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 
Warning: The estimated gradient might be inaccurate. 

a =

     1
     1
     0
     2
     0
     1


b =

     0


c =

     5


d = 

  <a href="matlab:helpPopup('struct')" style="font-weight:bold">struct</a> with fields:

      funcCount: 108
          fhist: [1 2 2 19 3 5 5 0 4 4 45 5 0.4225 0.4225 5.9340 1.5400 … ] (1×108 double)
      grad_hist: [6×8 double]
     grad_xhist: [6×8 double]
    alpha_final: [6×1 double]
        message: "The estimated gradient is small."

options.use_estimated_gradient_stop = false;
[a, b, c, d] = bds(q, p.x0, options)

a =

     1
     1
     0
     2
     0
     1


b =

     0


c =

     0


d = 

  <a href="matlab:helpPopup('struct')" style="font-weight:bold">struct</a> with fields:

      funcCount: 404
          fhist: [1 2 2 19 3 5 5 0 4 4 45 5 0.4225 0.4225 5.9340 1.5400 … ] (1×404 double)
      grad_hist: [6×32 double]
     grad_xhist: [6×32 double]
    alpha_final: [6×1 double]
        message: "The StepTolerance of the step size is reached."

clc
p = s2mpj_load('BIGGS6')

p = 

  <a href="matlab:helpPopup('Problem')" style="font-weight:bold">Problem</a> with properties:

              name: 'BIGGS6'
                x0: [6×1 double]
                xl: [6×1 double]
                xu: [6×1 double]
               aub: [0×6 double]
               bub: [0×1 double]
               aeq: [0×6 double]
               beq: [0×1 double]
                 n: 6
                mb: 0
       m_linear_ub: 0
       m_linear_eq: 0
    m_nonlinear_ub: 0
    m_nonlinear_eq: 0
             mlcon: 0
            mnlcon: 0
              mcon: 0
             ptype: 'u'

q = @(x) p.fun(x)

q =

  <a href="matlab:helpPopup('function_handle')" style="font-weight:bold">function_handle</a> with value:

    @(x)p.fun(x)

[a, b, c, d] = bds(q, p.x0, options)

a =

    3.5260
   13.4587
    1.5860
    4.6850
    1.2649
    1.3371


b =

    0.0012


c =

     2


d = 

  <a href="matlab:helpPopup('struct')" style="font-weight:bold">struct</a> with fields:

      funcCount: 3000
          fhist: [0.7791 1.4371 4.7694 0.7163 4.9703 4.8246 2.4915 … ] (1×3000 double)
      grad_hist: [6×10 double]
     grad_xhist: [6×10 double]
    alpha_final: [6×1 double]
        message: "The maximum number of function evaluations is reached."

[a, b, c, d] = bds(q, p.x0, options)

a =

    3.5260
   13.4587
    1.5860
    4.6850
    1.2649
    1.3371


b =

    0.0012


c =

     2


d = 

  <a href="matlab:helpPopup('struct')" style="font-weight:bold">struct</a> with fields:

      funcCount: 3000
          fhist: [0.7791 1.4371 4.7694 0.7163 4.9703 4.8246 2.4915 … ] (1×3000 double)
      grad_hist: [6×10 double]
     grad_xhist: [6×10 double]
    alpha_final: [6×1 double]
        message: "The maximum number of function evaluations is reached."

clc
options.use_estimated_gradient_stop = true;
[a, b, c, d] = bds(q, p.x0, options)
Warning: The estimated gradient might be inaccurate. 

a =

    3.5260
   13.4587
    1.5860
    4.6850
    1.2649
    1.3371


b =

    0.0012


c =

     2


d = 

  <a href="matlab:helpPopup('struct')" style="font-weight:bold">struct</a> with fields:

      funcCount: 3000
          fhist: [0.7791 1.4371 4.7694 0.7163 4.9703 4.8246 2.4915 … ] (1×3000 double)
      grad_hist: [6×10 double]
     grad_xhist: [6×10 double]
    alpha_final: [6×1 double]
        message: "The maximum number of function evaluations is reached."

clc
[a, b, c, d] = bds(q, p.x0, options)
Warning: The estimated gradient might be inaccurate. 

a =

    3.5260
   13.4587
    1.5860
    4.6850
    1.2649
    1.3371


b =

    0.0012


c =

     2


d = 

  <a href="matlab:helpPopup('struct')" style="font-weight:bold">struct</a> with fields:

      funcCount: 3000
          fhist: [0.7791 1.4371 4.7694 0.7163 4.9703 4.8246 2.4915 … ] (1×3000 double)
      grad_hist: [6×10 double]
     grad_xhist: [6×10 double]
    alpha_final: [6×1 double]
        message: "The maximum number of function evaluations is reached."

sqrt(1e-6 / 20)

ans =

   2.2361e-04

clc
sqrt(1e-6 / 20)

ans =

   2.2361e-04

clc
[a, b, c, d] = bds(q, p.x0, options)
alpha_all

alpha_all =

    0.0167
    0.0167
    0.0045
    0.0167
    0.0024
    0.0003

dbquit
clc
[a, b, c, d] = bds(q, p.x0, options)

a =

    3.5260
   13.4587
    1.5860
    4.6850
    1.2649
    1.3371


b =

    0.0012


c =

     2


d = 

  <a href="matlab:helpPopup('struct')" style="font-weight:bold">struct</a> with fields:

      funcCount: 3000
          fhist: [0.7791 1.4371 4.7694 0.7163 4.9703 4.8246 2.4915 … ] (1×3000 double)
      grad_hist: [6×10 double]
     grad_xhist: [6×10 double]
    alpha_final: [6×1 double]
        message: "The maximum number of function evaluations is reached."

clc
[a, b, c, d] = bds(q, p.x0, options)
alpha_all

alpha_all =

    0.0078
    0.0078
    0.0021
    0.0078
    0.0011
    0.0003

options

options = 

  <a href="matlab:helpPopup('struct')" style="font-weight:bold">struct</a> with fields:

     use_estimated_gradient_stop: 1
                      grad_tol_1: 0.1000
                      grad_tol_2: 1.0000e-03
          MaxFunctionEvaluations: 3000
                      num_blocks: 6
                      batch_size: 6
          block_visiting_pattern: 'sorted'
          block_selection_weight: [0.1667 0.1667 0.1667 0.1667 0.1667 0.1667]
                        is_noisy: 0
                          expand: 1.2500
                          shrink: 0.6500
               replacement_delay: 0
                      alpha_init: [6×1 double]
                   StepTolerance: [6×1 double]
                   cycling_inner: 1
                      debug_flag: 0
                forcing_function: @(alpha)alpha^2
                         ftarget: -Inf
                      func_tol_1: 1.0000e-06
                      func_tol_2: 1.0000e-09
                func_window_size: 10
                grad_window_size: 1
    gradient_estimation_complete: 0
                          iprint: 0
               output_alpha_hist: 0
               output_block_hist: 0
                    output_xhist: 0
                   polling_inner: "opportunistic"
                reduction_factor: [0 2.2204e-16 2.2204e-16]
                            seed: "shuffle"
         use_function_value_stop: 0

options.StepTolerance

ans =

   1.0e-06 *

    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000

dbquit
clc
options

options = 

  <a href="matlab:helpPopup('struct')" style="font-weight:bold">struct</a> with fields:

    use_estimated_gradient_stop: 1
                     grad_tol_1: 0.1000
                     grad_tol_2: 1.0000e-03
         MaxFunctionEvaluations: 3000

options.StepTolerance = eps;
[a, b, c, d] = bds(q, p.x0, options)
alpha_all

alpha_all =

    0.0078
    0.0078
    0.0021
    0.0078
    0.0011
    0.0003

dbcont
dbcont
dbcont
alpha_all

alpha_all =

    0.0067
    0.0067
    0.0018
    0.0067
    0.0009
    0.0001

dbquit
clc
[a, b, c, d] = bds(q, p.x0, options)

a =

    3.5260
   13.4587
    1.5860
    4.6850
    1.2649
    1.3371


b =

    0.0012


c =

     2


d = 

  <a href="matlab:helpPopup('struct')" style="font-weight:bold">struct</a> with fields:

      funcCount: 3000
          fhist: [0.7791 1.4371 4.7694 0.7163 4.9703 4.8246 2.4915 … ] (1×3000 double)
      grad_hist: [6×10 double]
     grad_xhist: [6×10 double]
    alpha_final: [6×1 double]
        message: "The maximum number of function evaluations is reached."

[a, b, c, d] = bds(q, p.x0, options)
norm(grad)

ans =

    0.2556

 max(1e-6, 1e-3 * norm(grad))

ans =

   2.5558e-04

dbquit
clc
p = s2mpj_load('BIGGS6')

p = 

  <a href="matlab:helpPopup('Problem')" style="font-weight:bold">Problem</a> with properties:

              name: 'BIGGS6'
                x0: [6×1 double]
                xl: [6×1 double]
                xu: [6×1 double]
               aub: [0×6 double]
               bub: [0×1 double]
               aeq: [0×6 double]
               beq: [0×1 double]
                 n: 6
                mb: 0
       m_linear_ub: 0
       m_linear_eq: 0
    m_nonlinear_ub: 0
    m_nonlinear_eq: 0
             mlcon: 0
            mnlcon: 0
              mcon: 0
             ptype: 'u'

clc
p = Feature()
{Not enough input arguments.

Error in <a href="matlab:matlab.lang.internal.introspective.errorDocCallback('Feature', '/Users/lihaitian/local/optiprofiler/matlab/optiprofiler/src/Feature.m', 264)" style="font-weight:bold">Feature</a> (<a href="matlab: opentoline('/Users/lihaitian/local/optiprofiler/matlab/optiprofiler/src/Feature.m',264,0)">line 264</a>)
            if ~ischarstr(name)
                          ^^^^
} 
p = Feature('BIGGS6')
{Error using <a href="matlab:matlab.lang.internal.introspective.errorDocCallback('Feature', '/Users/lihaitian/local/optiprofiler/matlab/optiprofiler/src/Feature.m', 274)" style="font-weight:bold">Feature</a> (<a href="matlab: opentoline('/Users/lihaitian/local/optiprofiler/matlab/optiprofiler/src/Feature.m',274,0)">line 274</a>)
Unknown feature: biggs6.
} 
clear all
clc
p = s2mpj_load('BIGGS6')

p = 

  <a href="matlab:helpPopup('Problem')" style="font-weight:bold">Problem</a> with properties:

              name: 'BIGGS6'
                x0: [6×1 double]
                xl: [6×1 double]
                xu: [6×1 double]
               aub: [0×6 double]
               bub: [0×1 double]
               aeq: [0×6 double]
               beq: [0×1 double]
                 n: 6
                mb: 0
       m_linear_ub: 0
       m_linear_eq: 0
    m_nonlinear_ub: 0
    m_nonlinear_eq: 0
             mlcon: 0
            mnlcon: 0
              mcon: 0
             ptype: 'u'

q = @(x) p.fun(x)

q =

  <a href="matlab:helpPopup('function_handle')" style="font-weight:bold">function_handle</a> with value:

    @(x)p.fun(x)

options.use_estimated_gradient_stop = true;
clear all
              parameters.grad_window_size = [10 1e8];
              parameters.grad_tol_1 = [1e-6 1e-30];
              parameters.grad_tol_2 = [1e-9 1e-30];
              parameters.maxfun_factor = [500 500];
              options = struct();
              options.solver_names = {'cbds-grad', 'cbds-default'};
clc
options.mindim = 5;
options.maxdim = 5;
options.feature_name = 'linearly_transformed';
tuning_optiprofiler(parameters, options)
